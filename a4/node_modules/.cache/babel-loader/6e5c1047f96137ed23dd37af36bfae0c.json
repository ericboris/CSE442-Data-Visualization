{"ast":null,"code":"var _jsxFileName = \"/Users/ericboris/Developer/CSE442/a4/src/components/Blockchain/SingleBlock.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Container, Form } from 'react-bootstrap';\nimport { sha256 } from 'js-sha256';\nimport { NumberField, ReadOnlyTextField, TextAreaField } from '../Fields';\nimport { MineButton, mine } from '../MineButton';\nimport MineSettings from '../MineSettings'; // Parse the mining settings.\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst difficulty = MineSettings.difficulty;\nconst pattern = MineSettings.pattern;\n\nclass SingleBlock extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      blockNumber: props.blockNumber,\n      nonce: props.startNonce,\n      data: \"\",\n      hash: \"\",\n      color: \"#50c878\",\n      prevHash: \"\",\n      blockIndex: 1,\n      signed: true\n    };\n  }\n\n  getHash() {\n    return sha256(this.state.blockNumber.toString() + this.state.nonce.toString() + this.state.data.toString() + this.state.prevHash.toString());\n  }\n\n  getPattern(hash) {\n    return hash.substr(0, difficulty);\n  }\n\n  isSigned() {\n    return this.getPattern(this.state.hash) === pattern ? true : false;\n  }\n\n  componentDidMount() {\n    // let nonce = mine(this.state.blockNumber, this.state.data, this.props.prevHash);\n    // this.setState({nonce});\n    let hash = this.getHash();\n    this.setState({\n      hash\n    });\n    let prevHash = '0000000000000000000000000000000000000000000000000000000000000000';\n    this.setState({\n      prevHash\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    let hash = this.getHash();\n\n    if (prevState.hash !== hash) {\n      this.setState({\n        hash\n      }); // Pass the updated hash up to the parent blockchain.\n\n      let response = {\n        blockIndex: this.props.blockIndex,\n        hash: this.state.hash\n      };\n      this.props.callback(response);\n    }\n\n    let prevHash = this.props.prevHash;\n\n    if (prevState.prevHash !== prevHash) {\n      this.setState({\n        prevHash\n      });\n    }\n\n    let signed = this.isSigned(); //console.log(\"BlockNum: \", this.state.blockNumber, \" PrevHash: \", this.props.prevHash);\n\n    if (prevState.signed !== signed) {\n      this.setState({\n        signed\n      });\n      this.setState({\n        color: signed ? '#50c878' : '#ff0000'\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        style: {\n          'width': 350,\n          'height': 500,\n          'background-color': this.state.color\n        },\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(NumberField, {\n            label: 'Block Number:',\n            value: this.state.blockNumber,\n            callback: blockNumber => this.setState({\n              blockNumber\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(NumberField, {\n            label: 'Nonce:',\n            value: this.state.nonce,\n            callback: nonce => this.setState({\n              nonce\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TextAreaField, {\n            label: 'Data:',\n            callback: data => this.setState({\n              data\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(ReadOnlyTextField, {\n            label: 'Prev:',\n            value: this.props.prevHash,\n            callback: prevHash => this.setState({\n              prevHash\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(ReadOnlyTextField, {\n            label: 'Hash:',\n            value: this.state.hash,\n            callback: hash => this.setState({\n              hash\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(MineButton, {\n            blockNumber: this.state.blockNumber,\n            data: this.state.data,\n            prevHash: this.state.prevHash,\n            callback: nonce => this.setState({\n              nonce\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default SingleBlock;","map":{"version":3,"sources":["/Users/ericboris/Developer/CSE442/a4/src/components/Blockchain/SingleBlock.js"],"names":["React","useState","useEffect","Container","Form","sha256","NumberField","ReadOnlyTextField","TextAreaField","MineButton","mine","MineSettings","difficulty","pattern","SingleBlock","Component","constructor","props","state","blockNumber","nonce","startNonce","data","hash","color","prevHash","blockIndex","signed","getHash","toString","getPattern","substr","isSigned","componentDidMount","setState","componentDidUpdate","prevProps","prevState","response","callback","render"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Container, Form } from 'react-bootstrap';\nimport { sha256 } from 'js-sha256';\nimport { NumberField, ReadOnlyTextField, TextAreaField } from '../Fields';\nimport { MineButton, mine } from '../MineButton';\nimport MineSettings from '../MineSettings';\n\n// Parse the mining settings.\nconst difficulty = MineSettings.difficulty;\nconst pattern = MineSettings.pattern;\n\nclass SingleBlock extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            blockNumber: props.blockNumber,\n            nonce: props.startNonce,\n            data: \"\",\n            hash: \"\",\n            color: \"#50c878\",\n            prevHash: \"\",\n            blockIndex: 1,\n            signed: true\n        };\n    }\n\n    getHash() {\n        return sha256(this.state.blockNumber.toString() + this.state.nonce.toString() + this.state.data.toString() + this.state.prevHash.toString());\n    }\n\n    getPattern(hash) {\n        return hash.substr(0, difficulty);\n    }\n\n    isSigned() {\n        return (this.getPattern(this.state.hash) === pattern) ? true : false;\n    }\n\n    componentDidMount() {\n        // let nonce = mine(this.state.blockNumber, this.state.data, this.props.prevHash);\n        // this.setState({nonce});\n        let hash = this.getHash();\n        this.setState({hash});\n        let prevHash = '0000000000000000000000000000000000000000000000000000000000000000';\n        this.setState({prevHash});\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        let hash = this.getHash();\n        if (prevState.hash !== hash) {\n            this.setState({hash});\n\n            // Pass the updated hash up to the parent blockchain.\n            let response = {blockIndex: this.props.blockIndex, hash: this.state.hash};\n            this.props.callback(response);\n        }\n\n        let prevHash = this.props.prevHash;\n        if (prevState.prevHash !== prevHash) {\n            this.setState({prevHash});\n        }\n\n        let signed = this.isSigned();\n        //console.log(\"BlockNum: \", this.state.blockNumber, \" PrevHash: \", this.props.prevHash);\n        if (prevState.signed !== signed) {\n            this.setState({signed});\n            this.setState({color: signed ? '#50c878' : '#ff0000'});\n        }\n    }\n\n    render() {\n        return (\n            <Container>\n                <Container\n                    style={{\n                        'width':350,\n                        'height':500,\n                        'background-color':this.state.color\n                    }}\n                >\n                    <Form>\n                        <br/>\n                        <NumberField\n                            label={'Block Number:'}\n                            value={this.state.blockNumber}\n                            callback={(blockNumber) => this.setState({blockNumber})}\n                        />\n                        <NumberField\n                            label={'Nonce:'}\n                            value={this.state.nonce}\n                            callback={(nonce) => this.setState({nonce})}\n                        />\n                        <TextAreaField\n                            label={'Data:'}\n                            callback={(data) => this.setState({data})}\n                        />\n                        <ReadOnlyTextField\n                            label={'Prev:'}\n                            value={this.props.prevHash}\n                            callback={(prevHash) => this.setState({prevHash})}\n                        />\n                        <ReadOnlyTextField\n                            label={'Hash:'}\n                            value={this.state.hash}\n                            callback={(hash) => this.setState({hash})}\n                        />\n                        <br/>\n                        <MineButton\n                            blockNumber={this.state.blockNumber}\n                            data={this.state.data}\n                            prevHash={this.state.prevHash}\n                            callback={(nonce) => this.setState({nonce})}\n                        />\n                    </Form>\n                </Container>\n            </Container>\n        );\n    }\n}\n\nexport default SingleBlock;\n"]},"metadata":{},"sourceType":"module"}