{"ast":null,"code":"var _jsxFileName = \"/Users/ericboris/Developer/CSE442/a4/src/components/Blockchain/SingleBlock.js\";\nimport React, { Component } from 'react';\nimport { Container, Form } from 'react-bootstrap';\nimport { sha256 } from 'js-sha256';\nimport { NumberField, ReadOnlyTextField, TextAreaField } from '../Fields';\nimport { MineButton, mine } from '../MineButton';\nimport MineSettings from '../MineSettings'; // Parse the mining settings.\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst difficulty = MineSettings.difficulty;\nconst pattern = MineSettings.pattern;\n\nclass SingleBlock extends Component {\n  constructor(props) {\n    super(props);\n\n    this.setData = nonce => this.setState({\n      block: { ...this.state.block,\n        nonce\n      }\n    });\n\n    this.state = {\n      block: props.block,\n      color: \"#50c878\",\n      signed: true\n    };\n  }\n  /* Given a block return its hash.\n   * Assumes the block only contains fields that should be hashed plus \n   * a hash field, which is excluded.\n   */\n\n\n  getHash(block) {\n    // If one exists, remove a 'hash' field from the block.\n    let filteredBlock = Object.fromEntries(Object.entries(block).filter(_ref => {\n      let [key] = _ref;\n      return key !== 'hash';\n    })); // And concatenate the remaining field values into a string.\n\n    let str = Object.values(filteredBlock).map(field => field.toString()).join('');\n    return sha256(str);\n  }\n\n  getPattern(hash) {\n    return hash.substr(0, difficulty);\n  }\n\n  isSigned() {\n    return this.getPattern(this.state.hash) === pattern ? true : false;\n  }\n  /*\n  componentDidMount() {\n      // let nonce = mine(this.state.blockNumber, this.state.data, this.props.prevHash);\n      // this.setState({nonce});\n      let hash = this.getHash();\n      this.setState({hash});\n      let prevHash = '0000000000000000000000000000000000000000000000000000000000000000';\n      this.setState({prevHash});\n  }\n  */\n\n\n  componentDidUpdate(prevProps, prevState) {\n    const hash = this.getHash(this.state.block);\n    console.log(\"HASH: \", hash);\n    console.log(\"PREV HASH: \", prevState.block.hash);\n\n    if (prevState.block.hash !== hash) {\n      this.setHash(hash);\n    }\n    /*\n    //let prevHash = this.props.prevHash;\n    if (prevState.prevHash !== prevHash) {\n        this.setState({prevHash});\n    }\n    */\n\n    /*\n    let signed = this.isSigned();\n    //console.log(\"BlockNum: \", this.state.blockNumber, \" PrevHash: \", this.props.prevHash);\n    if (prevState.signed !== signed) {\n        this.setState({signed});\n        this.setState({color: signed ? '#50c878' : '#ff0000'});\n    }\n    */\n\n    /*\n    if (prevState.block !== block)\n        // Pass the updated hash up to the parent blockchain.\n        this.props.callback(block);\n    }\n    */\n\n\n    console.log('BLOCK NUMBER: ', this.state.block.blockNumber);\n  }\n\n  setBlockNumber(blockNumber) {\n    this.setState({\n      block: { ...this.state.block,\n        blockNumber\n      }\n    });\n  }\n\n  setNonce(nonce) {\n    this.setState({\n      block: { ...this.state.block,\n        nonce\n      }\n    });\n  }\n\n  setHash(hash) {\n    this.setState({\n      block: { ...this.state.block,\n        hash\n      }\n    });\n  }\n\n  render() {\n    const color = this.state.color;\n    const block = this.state.block;\n    const {\n      blockNumber,\n      nonce,\n      data,\n      hash\n    } = block;\n    const prevHash = this.props.prevHash;\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        style: {\n          'width': 350,\n          'height': 500,\n          'background-color': color\n        },\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(NumberField, {\n            label: 'Block Number:',\n            value: blockNumber,\n            callback: blockNumber => this.setBlockNumber(blockNumber)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(NumberField, {\n            label: 'Nonce:',\n            value: nonce,\n            callback: nonce => this.setState({ ...block,\n              nonce\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TextAreaField, {\n            label: 'Data:',\n            callback: data => this.setState({ ...block,\n              data\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(ReadOnlyTextField, {\n            label: 'Prev:',\n            value: this.props.prevHash,\n            callback: prevHash => this.setState({\n              prevHash\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(ReadOnlyTextField, {\n            label: 'Hash:',\n            value: hash,\n            callback: hash => this.setState({\n              hash\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(MineButton, {\n            blockNumber: blockNumber,\n            data: data,\n            prevHash: this.props.prevHash,\n            callback: nonce => this.setState({\n              nonce\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default SingleBlock;","map":{"version":3,"sources":["/Users/ericboris/Developer/CSE442/a4/src/components/Blockchain/SingleBlock.js"],"names":["React","Component","Container","Form","sha256","NumberField","ReadOnlyTextField","TextAreaField","MineButton","mine","MineSettings","difficulty","pattern","SingleBlock","constructor","props","setData","nonce","setState","block","state","color","signed","getHash","filteredBlock","Object","fromEntries","entries","filter","key","str","values","map","field","toString","join","getPattern","hash","substr","isSigned","componentDidUpdate","prevProps","prevState","console","log","setHash","blockNumber","setBlockNumber","setNonce","render","data","prevHash"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Container, Form } from 'react-bootstrap';\nimport { sha256 } from 'js-sha256';\nimport { NumberField, ReadOnlyTextField, TextAreaField } from '../Fields';\nimport { MineButton, mine } from '../MineButton';\nimport MineSettings from '../MineSettings';\n\n// Parse the mining settings.\nconst difficulty = MineSettings.difficulty;\nconst pattern = MineSettings.pattern;\n\nclass SingleBlock extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            block: props.block,\n            color: \"#50c878\",\n            signed: true\n        };\n    }\n\n    /* Given a block return its hash.\n     * Assumes the block only contains fields that should be hashed plus \n     * a hash field, which is excluded.\n     */\n    getHash(block) {\n        // If one exists, remove a 'hash' field from the block.\n        let filteredBlock = Object.fromEntries(Object.entries(block).filter(([key]) => key !== 'hash'));\n        // And concatenate the remaining field values into a string.\n        let str = Object.values(filteredBlock).map(field => field.toString()).join('');\n        return sha256(str);\n    }\n\n    getPattern(hash) {\n        return hash.substr(0, difficulty);\n    }\n\n    isSigned() {\n        return (this.getPattern(this.state.hash) === pattern) ? true : false;\n    }\n\n    /*\n    componentDidMount() {\n        // let nonce = mine(this.state.blockNumber, this.state.data, this.props.prevHash);\n        // this.setState({nonce});\n        let hash = this.getHash();\n        this.setState({hash});\n        let prevHash = '0000000000000000000000000000000000000000000000000000000000000000';\n        this.setState({prevHash});\n    }\n    */\n\n    componentDidUpdate(prevProps, prevState) {\n        const hash = this.getHash(this.state.block);\n        console.log(\"HASH: \", hash);\n        console.log(\"PREV HASH: \", prevState.block.hash);\n        if (prevState.block.hash !== hash) {\n            this.setHash(hash);\n        }\n        /*\n        //let prevHash = this.props.prevHash;\n        if (prevState.prevHash !== prevHash) {\n            this.setState({prevHash});\n        }\n        */\n        /*\n        let signed = this.isSigned();\n        //console.log(\"BlockNum: \", this.state.blockNumber, \" PrevHash: \", this.props.prevHash);\n        if (prevState.signed !== signed) {\n            this.setState({signed});\n            this.setState({color: signed ? '#50c878' : '#ff0000'});\n        }\n        */\n        /*\n        if (prevState.block !== block)\n            // Pass the updated hash up to the parent blockchain.\n            this.props.callback(block);\n        }\n        */\n        console.log('BLOCK NUMBER: ', this.state.block.blockNumber);\n    }\n\n    setData = (nonce) => this.setState({ block: { ...this.state.block, nonce } });\n\n    setBlockNumber(blockNumber) {\n        this.setState({\n            block: {\n                ...this.state.block,\n                blockNumber\n            }\n        });\n    };\n\n    setNonce(nonce) {\n        this.setState({\n            block: {\n                ...this.state.block,\n                nonce\n            }\n        });\n    };\n\n\n\n    setHash(hash) {\n        this.setState({\n            block: {\n                ...this.state.block,\n                hash\n            }\n        });\n    }\n\n    render() {\n        const color = this.state.color;\n        const block = this.state.block;\n        const { blockNumber, nonce, data, hash } = block;\n        const prevHash = this.props.prevHash;\n\n        return (\n            <Container>\n                <Container\n                    style={{\n                        'width':350,\n                        'height':500,\n                        'background-color':color,\n                    }}\n                >\n                    <Form>\n                        <br/>\n                        <NumberField\n                            label={'Block Number:'}\n                            value={blockNumber}\n                            callback={(blockNumber) => this.setBlockNumber(blockNumber)}\n                        />\n                        <NumberField\n                            label={'Nonce:'}\n                            value={nonce}\n                            callback={(nonce) => this.setState({...block, nonce})}\n                        />\n                        <TextAreaField\n                            label={'Data:'}\n                            callback={(data) => this.setState({...block, data})}\n                        />\n                        <ReadOnlyTextField\n                            label={'Prev:'}\n                            value={this.props.prevHash}\n                            callback={(prevHash) => this.setState({prevHash})}\n                        />\n                        <ReadOnlyTextField\n                            label={'Hash:'}\n                            value={hash}\n                            callback={(hash) => this.setState({hash})}\n                        />\n                        <br/>\n                        <MineButton\n                            blockNumber={blockNumber}\n                            data={data}\n                            prevHash={this.props.prevHash}\n                            callback={(nonce) => this.setState({nonce})}\n                        />\n                    </Form>\n                </Container>\n            </Container>\n        );\n    }\n}\n\nexport default SingleBlock;\n"]},"metadata":{},"sourceType":"module"}